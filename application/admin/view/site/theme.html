<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>主题选择</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/static/admin/style/admin.css" media="all">
</head>
<body>

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-form layui-card-header layuiadmin-card-header-auto">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">主题</label>
                    <div class="layui-input-block">
                        <input type="text" name="search" placeholder="主题名称" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">颜色</label>
                    <div class="layui-input-block">
                        <select name="color" id="" class="layui-input">
                            <option value="">请选择</option>
                            <?php foreach(config('dictionary.theme_color') as $v) : ?>
                            <option value="{$v['id']}">{$v['value']}</option>
                            <?php endforeach ?>
                        </select>
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">类型</label>
                    <div class="layui-input-block">
                        <select name="category" id="" class="layui-input">
                            <option value="">请选择</option>
                            <?php foreach(config('dictionary.category') as $k=>$v) : ?>
                            <option value="{$k}">{$v}</option>
                            <?php endforeach ?>
                        </select>
                    </div>
                </div>
                <div class="layui-inline">
                    <button class="layui-btn layuiadmin-btn-admin" lay-submit lay-filter="search">
                        <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                    </button>
                    <button class="layui-btn">
                        <i class="layui-icon layui-icon-refresh layuiadmin-button-btn"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="layui-card-body">
            <table id="theme-table" lay-filter="theme-table"></table>
            <script type="text/html" id="thumb">
                <img src="{{ d.thumb }}" alt="">
            </script>
        </div>
    </div>
</div>

<script src="/static/layui/layui.js"></script>
<script src="/static/common/js/layTool.js"></script>
<script src="/static/common/js/jquery.min.js"></script>

<script>
    layui.config({
        base: '/static/admin/'
    }).use(['table'], function (){
        var $ = layui.$, form = layui.form, table = layui.table;
        $('.layui-icon-refresh').on('click', function (){
            $('.layui-input').val('');
        });
        // 监听搜索
        form.on('submit(search)', function (data){
            let field = data.field;
            // 执行重载
            table.reload('theme-table', {
                where: field
            });
        });
        table.render({
            elem: '#theme-table',
            url: "/admin/site/theme",
            title: '主题选择',
            page: true,
            cols: [[
                { type: 'radio', },
                { field: "theme_id", title: "主题ID", align: 'right', width: 80, },
                { field: "thumb", title: "缩略图", width: 100, templet: '#thumb', },
                { field: "temp_name", title: "主题名称", width: 100, },
                { field: "category", title: "类型", width: 150 },
                { field: "color", title: "颜色", width: 100 },
                { field: "is_h5", title: "响应式", align: 'center', width: 100 },
                { field: "count", title: "使用量", width: 100 },
                { field: "shoulu", title: "收录情况", width: 100 },
                { field: "paiming", title: "排名情况", align: 'right', width: 100 },
                { field: "zhuanhua", title: "转化情况", align: 'right', width: 100 },
                { field: "temp_url", title: "预览地址", width: 150 },
                { field: "add_time", title: "添加时间", align: 'right', width: 100 },
                { field: "edit_time", title: "修改时间", width: 100 },
            ]],
            done: function (res, curr, count){
                table.on('row(theme-table)', function (obj){
                    $('input[name=tem_temp_id]', window.parent.document).val(obj.data.temp_id);
                    $('input[name=tem_temp_name]', window.parent.document).val(obj.data.temp_name);
                    $('input[name=tem_temp_ish5]', window.parent.document).val(obj.data.is_h5);
                    $('input[name=tem_cat_id]', window.parent.document).val(obj.data.cat_id);
                });
            }
        });
    });
</script>
</body>
</html>
